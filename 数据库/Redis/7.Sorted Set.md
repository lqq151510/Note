Redis 的 **Sorted Set (ZSet)** 是 Redis 最具特色的数据结构之一。它在 Set 的基础上，为每个元素关联了一个 **Score（分值）**。

虽然集合内的元素是唯一的，但 **Score 可以重复**。Redis 正是利用这个分值来为集合中的成员进行**从小到大**的排序。其底层结合了哈希表（用于 $O(1)$ 查询元素）和 **跳跃表 (Skip List)**（用于高效的范围查询）。

---

### 1. 基础操作（添加与修改）

- **`ZADD key score1 member1 [score2 member2]`**: 向有序集合添加一个或多个成员，或者更新已存在成员的分数。
    
- **`ZINCRBY key increment member`**: 为有序集合中的指定成员的分数加上增量 `increment`。
    
- **`ZREM key member1 [member2]`**: 移除有序集合中的一个或多个成员。
    

### 2. 查询与统计 (Query)

- **`ZSCORE key member`**: 返回有序集合中指定成员的分数。
    
- **`ZRANK key member`**: 返回成员的排名（按分数从小到大，从 0 开始）。
    
- **`ZREVRANK key member`**: 返回成员的倒序排名（按分数从大到小，常用于排行榜）。
    
- **`ZCARD key`**: 获取有序集合的成员数。
    
- **`ZCOUNT key min max`**: 计算在指定分数区间内的成员数量。
    

### 3. 范围获取 (Range)

- **`ZRANGE key start stop [WITHSCORES]`**: 返回指定排名区间内的成员（从小到大）。
    
- **`ZREVRANGE key start stop [WITHSCORES]`**: 返回指定排名区间内的成员（从大到小）。
    
- **`ZRANGEBYSCORE key min max [WITHSCORES] [LIMIT offset count]`**: 返回指定**分数区间**内的成员。
    

---

### 4. 集合运算（并、交）

Sorted Set 也支持集合间的运算，并可以指定分数的聚合方式（求和、取最大值等）。

- **`ZINTERSTORE destination numkeys key1 [key2] [WEIGHTS weight1...] [AGGREGATE SUM|MIN|MAX]`**: 计算给定的一个或多个有序集的交集。
    
- **`ZUNIONSTORE destination numkeys key1 [key2]...`**: 计算给定的一个或多个有序集的并集。
    

---

### 🚀 典型应用场景

|**场景**|**命令组合示例**|**逻辑说明**|
|---|---|---|
|**实时排行榜**|`ZADD` + `ZREVRANGE`|存入用户分数，直接取出 Top 10。|
|**带权重的任务队列**|`ZADD` + `ZRANGE`|分数作为优先级，分数越低越先处理。|
|**延时队列**|`ZADD` + `ZRANGEBYSCORE`|分数存入时间戳，轮询获取当前时间已到期的任务。|
|**范围过滤**|`ZCOUNT`|统计分数在 60-100 分之间的及格人数。|

### 💡 小贴士：索引与分数的区别

- **Rank (排名)**：是元素根据分数排好序后的序号（0, 1, 2...）。
    
- **Score (分数)**：是你手动赋予元素的业务数值（如积分、时间戳、价格）。
    

至此，Redis 最常用的三大集合类型（List, Set, ZSet）都介绍完了。**你想看看如何用这些命令实现一个具体的“热搜排行榜”功能吗？**