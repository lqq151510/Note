# Java字符串常用方法详解

## 一、字符串基础

### 字符串创建

```
// 1. 字面量创建（推荐）
String str1 = "Hello World";

// 2. 构造方法创建
String str2 = new String("Hello World");

// 3. 字符数组创建
char[] chars = {'H', 'e', 'l', 'l', 'o'};
String str3 = new String(chars);

// 4. byte数组创建
byte[] bytes = {72, 101, 108, 108, 111};  // "Hello"的ASCII
String str4 = new String(bytes);

// 5. StringBuilder/StringBuffer
String str5 = new StringBuilder("Hello").toString();
```

### 字符串不可变性

```
String s1 = "Hello";
String s2 = s1;  // s1和s2指向同一个对象
s1 = s1 + " World";  // 创建了新对象，s1指向新对象
System.out.println(s1);  // "Hello World"
System.out.println(s2);  // "Hello" 未改变
```

---

## 二、字符串长度和空值检查

```
String str = "Hello Java";

// 1. 获取长度
int length = str.length();  // 10

// 2. 检查是否为空
boolean isEmpty = str.isEmpty();  // false
String emptyStr = "";
boolean isEmpty2 = emptyStr.isEmpty();  // true

// 3. 检查是否为空白（Java 11+）
String blankStr = "   ";
boolean isBlank1 = blankStr.isBlank();  // true
boolean isBlank2 = emptyStr.isBlank();   // true
boolean isBlank3 = str.isBlank();        // false

// 4. 检查是否为空或null
String nullStr = null;
String empty = "";
String whitespace = "   ";

// 传统检查方法
boolean isNullOrEmpty1 = str == null || str.isEmpty();
// Java 11+ 推荐
boolean isNullOrEmpty2 = str == null || str.isBlank();
```

---

## 三、字符串查找方法

```
String text = "Java Programming is fun. Java is powerful.";

// 1. 查找字符位置
int index1 = text.indexOf('a');      // 1 - 第一个'a'的位置
int index2 = text.indexOf('a', 2);   // 3 - 从索引2开始找
int lastIndex = text.lastIndexOf('a');  // 28 - 最后一个'a'

// 2. 查找子字符串
int strIndex1 = text.indexOf("Java");     // 0
int strIndex2 = text.indexOf("Java", 5);  // 22
int strLastIndex = text.lastIndexOf("Java");  // 22

// 3. 检查是否包含
boolean contains1 = text.contains("fun");     // true
boolean contains2 = text.contains("Python");  // false

// 4. 检查开头和结尾
boolean startsWith1 = text.startsWith("Java");  // true
boolean startsWith2 = text.startsWith("java");  // false（区分大小写）
boolean startsWith3 = text.startsWith("Pro", 5);  // 从索引5开始检查
boolean endsWith = text.endsWith("ful.");      // true

// 5. 查找多个字符
int indexOfAny = text.indexOf("aeiou");  // 返回第一个元音字母的位置
```

---

## 四、字符串截取和分割

```
String str = "Hello,Java,World,Programming";

// 1. 截取子字符串
String sub1 = str.substring(7);      // "Java,World,Programming" (从7开始)
String sub2 = str.substring(7, 11);  // "Java" (7到10，不包含11)

// 2. 分割字符串
String[] parts1 = str.split(",");  // ["Hello", "Java", "World", "Programming"]
String[] parts2 = str.split(",", 2);  // ["Hello", "Java,World,Programming"] 限制2部分

// 3. 特殊字符分割（需要转义）
String path = "C:\\Users\\John\\Documents";
String[] pathParts = path.split("\\\\");  // ["C:", "Users", "John", "Documents"]

// 4. 正则表达式分割
String text = "apple123banana456cherry";
String[] words = text.split("\\d+");  // ["apple", "banana", "cherry"]

// 5. 多分隔符分割
String complex = "apple,banana;orange grape";
String[] fruits = complex.split("[,; ]");  // 逗号、分号、空格分割
```

---

## 五、字符串修改和转换

### 大小写转换

```
String str = "Hello World";

// 转大写
String upper = str.toUpperCase();  // "HELLO WORLD"

// 转小写
String lower = str.toLowerCase();  // "hello world"

// 首字母大写（需要自己实现）
String capitalize = str.substring(0, 1).toUpperCase() + 
                    str.substring(1).toLowerCase();
```

### 去除空白

```
String str = "  Hello World  \t\n";

// 去除两端空白
String trimmed = str.trim();  // "Hello World"

// 去除所有空白
String noSpaces = str.replaceAll("\\s", "");  // "HelloWorld"

// 去除开头空白（Java 11+）
String stripStart = str.stripLeading();  // "Hello World  \t\n"

// 去除结尾空白（Java 11+）
String stripEnd = str.stripTrailing();  // "  Hello World"

// 去除所有空白（Java 11+）
String stripAll = str.strip();  // "Hello World"
```

### 替换内容

```
String str = "I love Java. Java is great.";

// 替换所有匹配
String replaced1 = str.replace("Java", "Python");  // "I love Python. Python is great."
String replaced2 = str.replace('a', 'A');  // "I love JAvA. JAvA is greAt."

// 正则表达式替换
String replaced3 = str.replaceAll("J.*? ", "Python ");  // "I love Python Python is great."
String replaced4 = str.replaceFirst("Java", "Python");  // "I love Python. Java is great."

// 删除特定字符
String cleaned = "a1b2c3".replaceAll("\\d", "");  // "abc"
```

---

## 六、字符串比较

```
String str1 = "Hello";
String str2 = "hello";
String str3 = "Hello";
String str4 = new String("Hello");

// 1. equals - 精确比较（区分大小写）
boolean eq1 = str1.equals(str2);  // false
boolean eq2 = str1.equals(str3);  // true
boolean eq3 = str1.equals(str4);  // true

// 2. equalsIgnoreCase - 忽略大小写比较
boolean eqIgnore1 = str1.equalsIgnoreCase(str2);  // true

// 3. compareTo - 字典顺序比较
int cmp1 = "apple".compareTo("banana");  // 负数 (a < b)
int cmp2 = "banana".compareTo("apple");  // 正数 (b > a)
int cmp3 = "apple".compareTo("apple");   // 0 (相等)
int cmp4 = "Apple".compareTo("apple");   // 负数 (大写A的ASCII值小于小写a)

// 4. compareToIgnoreCase - 忽略大小写比较
int cmpIgnore = "Apple".compareToIgnoreCase("apple");  // 0

// 5. == 与 equals 的区别
boolean ref1 = (str1 == str3);  // true (都指向字符串常量池的同一对象)
boolean ref2 = (str1 == str4);  // false (str4是new创建的新对象)
boolean val1 = str1.equals(str4);  // true (值相同)
```

---

## 七、字符串连接和构建

```
// 1. + 运算符
String s1 = "Hello" + " " + "World";  // "Hello World"
int num = 100;
String s2 = "Value: " + num;  // "Value: 100"

// 2. concat 方法
String s3 = "Hello".concat(" ").concat("World");  // "Hello World"

// 3. String.join (Java 8+)
String s4 = String.join("-", "2023", "12", "25");  // "2023-12-25"
String s5 = String.join(", ", "Apple", "Banana", "Orange");  // "Apple, Banana, Orange"

// 4. String.format
String s6 = String.format("Name: %s, Age: %d, Score: %.2f", 
                          "John", 25, 95.5);  // "Name: John, Age: 25, Score: 95.50"

// 5. StringBuilder (可变，性能好)
StringBuilder sb1 = new StringBuilder();
sb1.append("Hello");
sb1.append(" ");
sb1.append("World");
String result1 = sb1.toString();  // "Hello World"

// 链式调用
String result2 = new StringBuilder()
    .append("Hello")
    .append(" ")
    .append("World")
    .toString();

// 6. StringBuffer (线程安全)
StringBuffer sb2 = new StringBuffer();
sb2.append("Hello").append(" World");
String result3 = sb2.toString();
```

---

## 八、字符串转换

```
String str = "123abc456";

// 1. 字符数组转换
char[] chars = str.toCharArray();  // 转为字符数组
String fromChars = new String(chars);  // 转回字符串

// 2. 字节数组转换
byte[] bytes = str.getBytes();  // 使用平台默认编码
byte[] utf8Bytes = str.getBytes("UTF-8");  // 指定编码
String fromBytes = new String(bytes);

// 3. 与其他类型互转
int num = Integer.parseInt("123");  // 字符串转int
double d = Double.parseDouble("123.45");  // 字符串转double
boolean b = Boolean.parseBoolean("true");  // 字符串转boolean

String fromInt = Integer.toString(123);  // int转字符串
String fromDouble = Double.toString(123.45);  // double转字符串
String fromBoolean = Boolean.toString(true);  // boolean转字符串

// 4. 值转字符串
String value1 = String.valueOf(123);  // "123"
String value2 = String.valueOf(123.45);  // "123.45"
String value3 = String.valueOf(true);  // "true"
String value4 = String.valueOf(new char[]{'a', 'b', 'c'});  // "abc"

// 5. 格式化
String formatted = String.format("%05d", 123);  // "00123" 补零
String hex = Integer.toHexString(255);  // "ff" 16进制
String binary = Integer.toBinaryString(5);  // "101" 2进制
```

---

## 九、字符串检查和处理

```
// 1. 字符处理
String str = "Hello123";

// 获取指定位置的字符
char ch = str.charAt(1);  // 'e'

// 字符统计
int codePoint = str.codePointAt(0);  // 72 (H的Unicode)
boolean isLetter = Character.isLetter('a');  // true
boolean isDigit = Character.isDigit('5');  // true
boolean isWhitespace = Character.isWhitespace(' ');  // true

// 2. 匹配检查
String email = "test@example.com";
boolean matches1 = email.matches("^[A-Za-z0-9+_.-]+@[A-Za-z0-9.-]+$");  // 邮箱验证

String ip = "192.168.1.1";
boolean matches2 = ip.matches("^\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}$");

// 3. 字符串重复
String repeated = "abc".repeat(3);  // "abcabcabc" (Java 11+)

// 4. 缩进处理
String text = "Hello\nWorld";
String indented = text.indent(4);  // 每行前加4个空格

// 5. 行处理 (Java 11+)
String multiLine = "Line 1\nLine 2\nLine 3";
multiLine.lines()  // 返回Stream<String>
    .forEach(System.out::println);
```

---

## 十、实际应用示例

### 示例1：用户输入验证

```
public class InputValidator {
    
    public static boolean isValidUsername(String username) {
        if (username == null || username.isBlank()) {
            return false;
        }
        // 3-20个字符，只能包含字母数字和下划线
        return username.matches("^[a-zA-Z0-9_]{3,20}$");
    }
    
    public static boolean isValidEmail(String email) {
        if (email == null) return false;
        String pattern = "^[A-Za-z0-9+_.-]+@[A-Za-z0-9.-]+\\.[A-Za-z]{2,}$";
        return email.matches(pattern);
    }
    
    public static boolean isValidPassword(String password) {
        if (password == null || password.length() < 8) {
            return false;
        }
        // 必须包含大小写字母和数字
        boolean hasUpper = password.matches(".*[A-Z].*");
        boolean hasLower = password.matches(".*[a-z].*");
        boolean hasDigit = password.matches(".*\\d.*");
        return hasUpper && hasLower && hasDigit;
    }
}
```

### 示例2：字符串工具类

```
public class StringUtils {
    
    // 首字母大写
    public static String capitalize(String str) {
        if (str == null || str.isEmpty()) {
            return str;
        }
        return str.substring(0, 1).toUpperCase() + str.substring(1).toLowerCase();
    }
    
    // 反转字符串
    public static String reverse(String str) {
        if (str == null) return null;
        return new StringBuilder(str).reverse().toString();
    }
    
    // 统计子字符串出现次数
    public static int countOccurrences(String text, String substring) {
        if (text == null || substring == null || substring.isEmpty()) {
            return 0;
        }
        int count = 0;
        int index = 0;
        while ((index = text.indexOf(substring, index)) != -1) {
            count++;
            index += substring.length();
        }
        return count;
    }
    
    // 去除所有空白字符
    public static String removeWhitespace(String str) {
        if (str == null) return null;
        return str.replaceAll("\\s+", "");
    }
    
    // 检查是否是回文
    public static boolean isPalindrome(String str) {
        if (str == null) return false;
        String cleaned = str.replaceAll("[^a-zA-Z0-9]", "").toLowerCase();
        return cleaned.equals(reverse(cleaned));
    }
}
```

### 示例3：CSV文件解析

```
public class CSVParser {
    
    public static List<String[]> parseCSV(String csvContent) {
        List<String[]> result = new ArrayList<>();
        if (csvContent == null || csvContent.isBlank()) {
            return result;
        }
        
        String[] lines = csvContent.split("\n");
        for (String line : lines) {
            // 处理带引号和逗号的情况
            List<String> fields = new ArrayList<>();
            StringBuilder field = new StringBuilder();
            boolean inQuotes = false;
            
            for (int i = 0; i < line.length(); i++) {
                char ch = line.charAt(i);
                
                if (ch == '"') {
                    inQuotes = !inQuotes;
                } else if (ch == ',' && !inQuotes) {
                    fields.add(field.toString());
                    field.setLength(0);
                } else {
                    field.append(ch);
                }
            }
            fields.add(field.toString());  // 添加最后一个字段
            result.add(fields.toArray(new String[0]));
        }
        return result;
    }
}
```

### 示例4：URL参数解析

```
public class URLParser {
    
    public static Map<String, String> parseQueryString(String queryString) {
        Map<String, String> params = new HashMap<>();
        if (queryString == null || queryString.isEmpty()) {
            return params;
        }
        
        String[] pairs = queryString.split("&");
        for (String pair : pairs) {
            String[] keyValue = pair.split("=", 2);
            if (keyValue.length == 2) {
                try {
                    String key = java.net.URLDecoder.decode(keyValue[0], "UTF-8");
                    String value = java.net.URLDecoder.decode(keyValue[1], "UTF-8");
                    params.put(key, value);
                } catch (Exception e) {
                    // 忽略解码错误
                }
            }
        }
        return params;
    }
    
    public static String buildQueryString(Map<String, String> params) {
        if (params == null || params.isEmpty()) {
            return "";
        }
        
        StringBuilder sb = new StringBuilder();
        boolean first = true;
        for (Map.Entry<String, String> entry : params.entrySet()) {
            if (!first) {
                sb.append("&");
            }
            try {
                String key = java.net.URLEncoder.encode(entry.getKey(), "UTF-8");
                String value = java.net.URLEncoder.encode(entry.getValue(), "UTF-8");
                sb.append(key).append("=").append(value);
            } catch (Exception e) {
                // 忽略编码错误
            }
            first = false;
        }
        return sb.toString();
    }
}
```

---

## 十一、性能注意事项

### 1. 字符串拼接性能对比

```
// 方法1: + 运算符 (不推荐在循环中使用)
String result = "";
for (int i = 0; i < 1000; i++) {
    result += i;  // 每次创建新String对象，性能差
}

// 方法2: StringBuilder (推荐)
StringBuilder sb = new StringBuilder();
for (int i = 0; i < 1000; i++) {
    sb.append(i);
}
String result2 = sb.toString();

// 方法3: StringBuffer (线程安全，性能稍差)
StringBuffer buffer = new StringBuffer();
for (int i = 0; i < 1000; i++) {
    buffer.append(i);
}
String result3 = buffer.toString();
```

### 2. 字符串常量池

```
String s1 = "hello";  // 在常量池
String s2 = "hello";  // 复用常量池中的对象
String s3 = new String("hello");  // 在堆中新建对象
String s4 = s3.intern();  // 放入常量池并返回

System.out.println(s1 == s2);  // true (同一个对象)
System.out.println(s1 == s3);  // false (不同对象)
System.out.println(s1 == s4);  // true (s4是常量池中的对象)
```

### 3. 字符串比较性能

```
// 比较字符串相等
String input = getUserInput();  // 假设返回"admin"

// 不好：可能空指针异常
if (input.equals("admin")) { }

// 好：避免空指针
if ("admin".equals(input)) { }

// 更好：Java 7+ 使用常量优先
if ("admin".equalsIgnoreCase(input)) { }
```

---

## 十二、常用方法速查表

|方法|描述|示例|
|---|---|---|
|`length()`|字符串长度|`"hello".length()`→ 5|
|`charAt(int)`|获取字符|`"hello".charAt(1)`→ 'e'|
|`substring(int)`|截取子串|`"hello".substring(1)`→ "ello"|
|`substring(int, int)`|截取子串|`"hello".substring(1,4)`→ "ell"|
|`indexOf(String)`|查找位置|`"hello".indexOf("l")`→ 2|
|`lastIndexOf(String)`|最后位置|`"hello".lastIndexOf("l")`→ 3|
|`contains(String)`|是否包含|`"hello".contains("ell")`→ true|
|`startsWith(String)`|是否开头|`"hello".startsWith("he")`→ true|
|`endsWith(String)`|是否结尾|`"hello".endsWith("lo")`→ true|
|`toUpperCase()`|转大写|`"hello".toUpperCase()`→ "HELLO"|
|`toLowerCase()`|转小写|`"Hello".toLowerCase()`→ "hello"|
|`trim()`|去两端空白|`" hello ".trim()`→ "hello"|
|`strip()`|去空白(Java 11+)|`" hello ".strip()`→ "hello"|
|`replace()`|替换|`"hello".replace('l','x')`→ "hexxo"|
|`replaceAll()`|正则替换|`"a1b2".replaceAll("\\d","")`→ "ab"|
|`split(String)`|分割|`"a,b,c".split(",")`→ ["a","b","c"]|
|`join(CharSequence, CharSequence...)`|连接|`String.join("-","a","b")`→ "a-b"|
|`equals(Object)`|比较相等|`"a".equals("a")`→ true|
|`equalsIgnoreCase(String)`|忽略大小写比较|`"A".equalsIgnoreCase("a")`→ true|
|`compareTo(String)`|字典比较|`"a".compareTo("b")`→ -1|
|`isEmpty()`|是否为空|`"".isEmpty()`→ true|
|`isBlank()`|是否空白(Java 11+)|`" ".isBlank()`→ true|
|`format(String, Object...)`|格式化|`String.format("%s-%d","a",1)`→ "a-1"|
|`valueOf(Object)`|转字符串|`String.valueOf(123)`→ "123"|
|`toCharArray()`|转字符数组|`"hi".toCharArray()`→ ['h','i']|
|`getBytes()`|转字节数组|`"hi".getBytes()`→ [104, 105]|
|`matches(String)`|正则匹配|`"123".matches("\\d+")`→ true|
|`repeat(int)`|重复(Java 11+)|`"a".repeat(3)`→ "aaa"|
|`lines()`|行流(Java 11+)|`"a\nb".lines().count()`→ 2|

---

## 十三、练习题

### 练习1：统计字符串信息

```
// 编写一个方法，统计字符串中的字母、数字、空格和其他字符的数量
public static void countCharacters(String str) {
    // TODO: 实现统计逻辑
}
```

### 练习2：验证回文串

```
// 忽略大小写和标点，判断是否是回文
// 例如："A man, a plan, a canal: Panama" 应该返回 true
public static boolean isPalindrome(String str) {
    // TODO: 实现回文判断
}
```

### 练习3：字符串压缩

```
// 实现字符串压缩：aabcccccaaa → a2b1c5a3
// 如果压缩后没有变短，返回原字符串
public static String compress(String str) {
    // TODO: 实现字符串压缩
}
```

### 练习4：查找最长不重复子串

```
// 查找字符串中最长的不包含重复字符的子串
// 例如："abcabcbb" 的最长不重复子串是 "abc"，长度为3
public static String longestUniqueSubstring(String str) {
    // TODO: 实现查找逻辑
}
```

---

记住关键点：

1. **字符串是不可变的**，每次修改都会创建新对象
    
2. 大量字符串操作使用 **StringBuilder**
    
3. 比较字符串内容用 **equals()**，不是 **==**
    
4. 注意**编码**和**性能**问题
    
5. Java 11+ 提供了更多便捷方法（如`isBlank()`、`strip()`、`repeat()`、`lines()`等）