Spring Bootçš„å…¨å±€å¼‚å¸¸å¤„ç†å™¨èƒ½é›†ä¸­å¤„ç†åº”ç”¨å¼‚å¸¸ï¼Œæä¾›ç»Ÿä¸€çš„é”™è¯¯å“åº”ï¼Œæ˜¯æ„å»ºå¥å£®åº”ç”¨çš„å…³é”®ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªç®€æ´çš„å¯¹æ¯”è¡¨æ ¼ï¼Œå¸®ä½ å¿«é€Ÿäº†è§£å…¶æ ¸å¿ƒå®ç°æ–¹å¼ã€‚

|å¤„ç†æ–¹å¼|æ ¸å¿ƒæœºåˆ¶|é€‚ç”¨åœºæ™¯|ä¼˜ç‚¹|
|---|---|---|---|
|**`@ControllerAdvice`+ `@ExceptionHandler`**â€‹|ä½¿ç”¨æ³¨è§£å®šä¹‰å…¨å±€å¼‚å¸¸å¤„ç†ç±»|REST APIã€Web MVCåº”ç”¨|å£°æ˜å¼ã€æ˜“äºé…ç½®ã€ä¸Spring MVCæ— ç¼é›†æˆ|
|**æ§åˆ¶å™¨å†… `@ExceptionHandler`**â€‹|åœ¨å•ä¸ªControllerå†…å®šä¹‰å¼‚å¸¸å¤„ç†æ–¹æ³•|ç‰¹å®šæ§åˆ¶å™¨çš„å¼‚å¸¸å¤„ç†|å¤„ç†é€»è¾‘ä¸æ§åˆ¶å™¨ç´§è€¦åˆï¼Œç²’åº¦æ›´ç»†|
|**å®ç° `HandlerExceptionResolver`æ¥å£**â€‹|å®ç°æ¥å£ï¼Œè‡ªå®šä¹‰å¼‚å¸¸è§£æé€»è¾‘|éœ€è¦é«˜åº¦å®šåˆ¶åŒ–å¼‚å¸¸å¤„ç†çš„å¤æ‚åœºæ™¯|çµæ´»æ€§é«˜ï¼Œå¯å®Œå…¨æ§åˆ¶å¤„ç†æµç¨‹|

å¯¹äºå¤§å¤šæ•°é¡¹ç›®ï¼Œç¬¬ä¸€ç§æ–¹å¼æœ€ä¸ºå¸¸ç”¨ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬è¯¦ç»†çœ‹çœ‹å¦‚ä½•å®ç°å®ƒã€‚

### ğŸ’» æ ¸å¿ƒå®ç°æ­¥éª¤

#### 1. åˆ›å»ºå…¨å±€å¼‚å¸¸å¤„ç†ç±»

ä½¿ç”¨ `@RestControllerAdvice`æ³¨è§£æ ‡è®°ä¸€ä¸ªç±»ï¼Œå®ƒç»“åˆäº† `@ControllerAdvice`å’Œ `@ResponseBody`ï¼Œèƒ½è‡ªåŠ¨å°†æ–¹æ³•è¿”å›å€¼è½¬æ¢ä¸ºJSONã€‚

```
@RestControllerAdvice
public class GlobalExceptionHandler {
    // å¼‚å¸¸å¤„ç†æ–¹æ³•å°†åœ¨è¿™é‡Œå®šä¹‰
}
```

#### 2. ç¼–å†™å¼‚å¸¸å¤„ç†æ–¹æ³•

åœ¨ç±»å†…éƒ¨ï¼Œä½¿ç”¨ `@ExceptionHandler`æ³¨è§£æ¥æŒ‡å®šè¯¥æ–¹æ³•å¤„ç†å“ªç§å¼‚å¸¸ã€‚

```
@ExceptionHandler(IllegalArgumentException.class)
public ResponseEntity<ErrorResponse> handleIllegalArgument(IllegalArgumentException e) {
    // 1. è®°å½•æ—¥å¿—ï¼ˆéå¸¸é‡è¦ï¼‰
    log.error("Illegal argument exception: {}", e.getMessage());
    // 2. æ„é€ å¹¶è¿”å›ç»Ÿä¸€çš„é”™è¯¯å“åº”ä½“
    ErrorResponse error = new ErrorResponse(400, "è¯·æ±‚å‚æ•°éæ³•");
    return new ResponseEntity<>(error, HttpStatus.BAD_REQUEST);
}
```

#### 3. è®¾è®¡ç»Ÿä¸€çš„é”™è¯¯å“åº”ä½“

å®šä¹‰ä¸€ä¸ªæ ‡å‡†çš„ç±»æ¥å°è£…é”™è¯¯ä¿¡æ¯ï¼Œæ–¹ä¾¿å‰ç«¯è§£æã€‚

```
@Data // ä½¿ç”¨Lombokç®€åŒ–ä»£ç 
@AllArgsConstructor
public class ErrorResponse {
    private int code; // é”™è¯¯ç 
    private String message; // é”™è¯¯ä¿¡æ¯
    private long timestamp; // æ—¶é—´æˆ³
    private String path; // è¯·æ±‚è·¯å¾„ï¼ˆå¯é€šè¿‡HttpServletRequestè·å–ï¼‰

    public ErrorResponse(int code, String message) {
        this.code = code;
        this.message = message;
        this.timestamp = System.currentTimeMillis();
    }
}
```

#### 4. åˆ›å»ºè‡ªå®šä¹‰å¼‚å¸¸ç±»

é€šè¿‡è‡ªå®šä¹‰ä¸šåŠ¡å¼‚å¸¸ï¼Œå¯ä»¥æ›´æ¸…æ™°åœ°è¡¨è¾¾é”™è¯¯ç±»å‹ã€‚

```
public class BusinessException extends RuntimeException {
    private final int errorCode;

    public BusinessException(int errorCode, String message) {
        super(message);
        this.errorCode = errorCode;
    }
    // Getter...
}
```

éšåï¼Œä½ å¯ä»¥åœ¨å…¨å±€å¼‚å¸¸å¤„ç†å™¨ä¸­ä¸“é—¨å¤„ç†è¿™ä¸ªè‡ªå®šä¹‰å¼‚å¸¸ã€‚

```
@ExceptionHandler(BusinessException.class)
public ResponseEntity<ErrorResponse> handleBusinessException(BusinessException e) {
    ErrorResponse error = new ErrorResponse(e.getErrorCode(), e.getMessage());
    return new ResponseEntity<>(error, HttpStatus.BAD_REQUEST);
}
```

### ğŸ” å…³é”®è¦ç‚¹ä¸æœ€ä½³å®è·µ

1. **å¼‚å¸¸åŒ¹é…ä¼˜å…ˆçº§**
    
    Springä¼šä¼˜å…ˆé€‰æ‹©æœ€åŒ¹é…çš„å¼‚å¸¸å¤„ç†å™¨ã€‚ä¾‹å¦‚ï¼Œ`NullPointerException`ä¼šä¼˜å…ˆç”± `@ExceptionHandler(NullPointerException.class)`å¤„ç†ï¼Œè€Œä¸æ˜¯ `@ExceptionHandler(Exception.class)`ã€‚å› æ­¤ï¼Œ**å¤„ç†å™¨çš„é¡ºåºåº”ä»å…·ä½“åˆ°ä¸€èˆ¬**ã€‚
    
2. **è®°å½•æ—¥å¿—**
    
    åŠ¡å¿…åœ¨å¼‚å¸¸å¤„ç†æ–¹æ³•ä¸­è®°å½•é”™è¯¯æ—¥å¿—ï¼Œè¿™æ˜¯åæœŸæ’æŸ¥é—®é¢˜çš„é‡è¦ä¾æ®ã€‚å¯ä»¥ä½¿ç”¨ `@Slf4j`æ³¨è§£ç®€åŒ–æ—¥å¿—æ“ä½œã€‚
    
3. **åŒºåˆ†ç¯å¢ƒè¿”å›ä¿¡æ¯**
    
    å‡ºäºå®‰å…¨è€ƒè™‘ï¼Œåœ¨ç”Ÿäº§ç¯å¢ƒä¸­åº”é¿å…å°†è¯¦ç»†çš„å¼‚å¸¸å †æ ˆä¿¡æ¯è¿”å›ç»™å®¢æˆ·ç«¯ï¼Œåªéœ€è¿”å›å‹å¥½æç¤ºã€‚åœ¨å¼€å‘ç¯å¢ƒåˆ™å¯ä»¥è¿”å›è¯¦ç»†ä¿¡æ¯ä»¥ä¾¿è°ƒè¯•ã€‚
    
4. **å¤„ç†æ‰€æœ‰æœªæ•è·å¼‚å¸¸**
    
    ä½¿ç”¨ `@ExceptionHandler(Exception.class)`ä½œä¸ºæœ€åçš„é˜²çº¿ï¼Œç¡®ä¿æ‰€æœ‰å¼‚å¸¸éƒ½èƒ½è¢«æ•è·å¹¶ç»Ÿä¸€å¤„ç†ã€‚
    

æ•´ä¸ªè¯·æ±‚ä¸å¼‚å¸¸å¤„ç†çš„è¿‡ç¨‹ï¼Œå¯ä»¥ç”¨ä¸‹é¢çš„æµç¨‹å›¾æ¥æ¦‚æ‹¬ï¼š

```
graph TD
    A[å®¢æˆ·ç«¯è¯·æ±‚] --> B[Controllerå¤„ç†è¯·æ±‚]
    B --> C{æ˜¯å¦æŠ›å‡ºå¼‚å¸¸?}
    C -- æ˜¯ --> D[å…¨å±€å¼‚å¸¸å¤„ç†å™¨æ‹¦æˆª]
    D --> E{åŒ¹é…æœ€å…·ä½“çš„å¼‚å¸¸å¤„ç†æ–¹æ³•}
    E --> F[è®°å½•æ—¥å¿—]
    F --> G[è¿”å›ç»Ÿä¸€çš„é”™è¯¯å“åº”JSON]
    C -- å¦ --> H[è¿”å›æ­£å¸¸ä¸šåŠ¡æ•°æ®]
    G --> I[å®¢æˆ·ç«¯æ”¶åˆ°é”™è¯¯ä¿¡æ¯]
    H --> I
```

### ğŸ’ æ€»ç»“

æ€»è€Œè¨€ä¹‹ï¼ŒSpring Bootå…¨å±€å¼‚å¸¸å¤„ç†å™¨çš„æ ¸å¿ƒåœ¨äºåˆ©ç”¨ `@RestControllerAdvice`å’Œ `@ExceptionHandler`å®ç°é›†ä¸­å¼å¼‚å¸¸ç®¡ç†ã€‚å…³é”®æ˜¯è¦è®¾è®¡å¥½ç»Ÿä¸€çš„å“åº”æ ¼å¼ã€æ³¨æ„å¼‚å¸¸åŒ¹é…çš„ä¼˜å…ˆçº§ï¼Œå¹¶åšå¥½æ—¥å¿—è®°å½•ã€‚

å¸Œæœ›è¿™äº›ä¿¡æ¯èƒ½å¸®åŠ©ä½ ã€‚å¦‚æœä½ åœ¨å®ç°è¿‡ç¨‹ä¸­é‡åˆ°æ›´å…·ä½“çš„åœºæ™¯ï¼ˆæ¯”å¦‚å¦‚ä½•å¤„ç†æ•°æ®æ ¡éªŒå¼‚å¸¸ï¼‰ï¼Œæˆ‘ä»¬å¯ä»¥ç»§ç»­æ¢è®¨ã€‚