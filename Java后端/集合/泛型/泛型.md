# Java æ³›å‹è¯¦è§£

## ğŸ“‹ æ³›å‹æ¦‚è¿°

**æ³›å‹**â€‹ æ˜¯ Java 5 å¼•å…¥çš„é‡è¦ç‰¹æ€§ï¼Œå®ƒå…è®¸åœ¨å®šä¹‰ç±»ã€æ¥å£ã€æ–¹æ³•æ—¶ä½¿ç”¨**ç±»å‹å‚æ•°**ï¼Œä½¿å¾—ä»£ç å¯ä»¥å¤„ç†å¤šç§æ•°æ®ç±»å‹ï¼ŒåŒæ—¶ä¿æŒç±»å‹å®‰å…¨ã€‚æ³›å‹çš„æ ¸å¿ƒæ€æƒ³æ˜¯**å‚æ•°åŒ–ç±»å‹**ã€‚

### ä¸»è¦ä¼˜ç‚¹ï¼š

- **ç±»å‹å®‰å…¨**ï¼šç¼–è¯‘æ—¶æ£€æŸ¥ç±»å‹ï¼Œé¿å…è¿è¡Œæ—¶ç±»å‹è½¬æ¢é”™è¯¯
    
- **ä»£ç å¤ç”¨**ï¼šä¸€å¥—ä»£ç å¯ç”¨äºå¤šç§æ•°æ®ç±»å‹
    
- **æ¶ˆé™¤å¼ºåˆ¶ç±»å‹è½¬æ¢**ï¼šå‡å°‘æ˜¾å¼ç±»å‹è½¬æ¢
    
- **æ›´å¥½çš„å¯è¯»æ€§**ï¼šä»£ç æ›´æ¸…æ™°åœ°è¡¨è¾¾äº†å…¶æ„å›¾
    

---

## ğŸ—ï¸ ç±»æ³›å‹

### 1. åŸºæœ¬è¯­æ³•

```
// å®šä¹‰æ³›å‹ç±»
public class ClassName<T> {
    // ä½¿ç”¨ç±»å‹å‚æ•°T
    private T data;
    
    public ClassName(T data) {
        this.data = data;
    }
    
    public T getData() {
        return data;
    }
    
    public void setData(T data) {
        this.data = data;
    }
}
```

### 2. å¤šä¸ªç±»å‹å‚æ•°

```
// å®šä¹‰åŒ…å«ä¸¤ä¸ªç±»å‹å‚æ•°çš„ç±»
public class Pair<K, V> {
    private K key;
    private V value;
    
    public Pair(K key, V value) {
        this.key = key;
        this.value = value;
    }
    
    public K getKey() { return key; }
    public V getValue() { return value; }
    
    public void setKey(K key) { this.key = key; }
    public void setValue(V value) { this.value = value; }
    
    @Override
    public String toString() {
        return "Pair{" + "key=" + key + ", value=" + value + '}';
    }
}
```

### 3. å®Œæ•´ç¤ºä¾‹

```
// æ³›å‹å®¹å™¨ç±»ç¤ºä¾‹
public class Container<T> {
    private T[] elements;  // æ³›å‹æ•°ç»„
    private int size;
    private int capacity;
    
    @SuppressWarnings("unchecked")
    public Container(int capacity) {
        this.capacity = capacity;
        // æ³¨æ„ï¼šä¸èƒ½ç›´æ¥åˆ›å»ºæ³›å‹æ•°ç»„ï¼Œéœ€è¦å¼ºåˆ¶è½¬æ¢
        this.elements = (T[]) new Object[capacity];
        this.size = 0;
    }
    
    public void add(T element) {
        if (size < capacity) {
            elements[size++] = element;
        } else {
            throw new IllegalStateException("å®¹å™¨å·²æ»¡");
        }
    }
    
    public T get(int index) {
        if (index < 0 || index >= size) {
            throw new IndexOutOfBoundsException("ç´¢å¼•è¶Šç•Œ");
        }
        return elements[index];
    }
    
    public boolean remove(T element) {
        for (int i = 0; i < size; i++) {
            if (elements[i].equals(element)) {
                // ç§»åŠ¨å…ƒç´ 
                for (int j = i; j < size - 1; j++) {
                    elements[j] = elements[j + 1];
                }
                elements[--size] = null;  // å¸®åŠ©GC
                return true;
            }
        }
        return false;
    }
    
    public int size() {
        return size;
    }
    
    public boolean isEmpty() {
        return size == 0;
    }
    
    public void clear() {
        for (int i = 0; i < size; i++) {
            elements[i] = null;
        }
        size = 0;
    }
}

// ä½¿ç”¨ç¤ºä¾‹
public class GenericClassDemo {
    public static void main(String[] args) {
        // å­˜å‚¨å­—ç¬¦ä¸²
        Container<String> stringContainer = new Container<>(5);
        stringContainer.add("Java");
        stringContainer.add("Python");
        stringContainer.add("C++");
        
        System.out.println("å­—ç¬¦ä¸²å®¹å™¨:");
        for (int i = 0; i < stringContainer.size(); i++) {
            System.out.println(stringContainer.get(i));
        }
        
        // å­˜å‚¨æ•´æ•°
        Container<Integer> intContainer = new Container<>(5);
        intContainer.add(100);
        intContainer.add(200);
        intContainer.add(300);
        
        System.out.println("\næ•´æ•°å®¹å™¨:");
        for (int i = 0; i < intContainer.size(); i++) {
            int value = intContainer.get(i);  // è‡ªåŠ¨æ‹†ç®±
            System.out.println(value * 2);
        }
        
        // å­˜å‚¨è‡ªå®šä¹‰å¯¹è±¡
        Container<Student> studentContainer = new Container<>(3);
        studentContainer.add(new Student("å¼ ä¸‰", 20));
        studentContainer.add(new Student("æå››", 22));
        
        System.out.println("\nå­¦ç”Ÿå®¹å™¨:");
        for (int i = 0; i < studentContainer.size(); i++) {
            System.out.println(studentContainer.get(i));
        }
    }
    
    static class Student {
        String name;
        int age;
        
        Student(String name, int age) {
            this.name = name;
            this.age = age;
        }
        
        @Override
        public String toString() {
            return "Student{name='" + name + "', age=" + age + "}";
        }
    }
}
```

### 4. æœ‰ç•Œç±»å‹å‚æ•°

```
// é™åˆ¶ç±»å‹å‚æ•°å¿…é¡»æ˜¯Numberæˆ–å…¶å­ç±»
public class NumericContainer<T extends Number> {
    private T[] numbers;
    private int size;
    
    @SuppressWarnings("unchecked")
    public NumericContainer(int capacity) {
        numbers = (T[]) new Number[capacity];
        size = 0;
    }
    
    public void add(T number) {
        if (size < numbers.length) {
            numbers[size++] = number;
        }
    }
    
    public double sum() {
        double total = 0.0;
        for (int i = 0; i < size; i++) {
            total += numbers[i].doubleValue();  // å¯ä»¥è°ƒç”¨Numberçš„æ–¹æ³•
        }
        return total;
    }
    
    public T max() {
        if (size == 0) return null;
        
        T max = numbers[0];
        for (int i = 1; i < size; i++) {
            if (numbers[i].doubleValue() > max.doubleValue()) {
                max = numbers[i];
            }
        }
        return max;
    }
}

// ä½¿ç”¨ç¤ºä¾‹
public class BoundedTypeDemo {
    public static void main(String[] args) {
        // å­˜å‚¨æ•´æ•°
        NumericContainer<Integer> intContainer = new NumericContainer<>(5);
        intContainer.add(10);
        intContainer.add(20);
        intContainer.add(30);
        System.out.println("æ•´æ•°æ€»å’Œ: " + intContainer.sum());
        System.out.println("æœ€å¤§å€¼: " + intContainer.max());
        
        // å­˜å‚¨æµ®ç‚¹æ•°
        NumericContainer<Double> doubleContainer = new NumericContainer<>(5);
        doubleContainer.add(3.14);
        doubleContainer.add(2.718);
        doubleContainer.add(1.618);
        System.out.println("æµ®ç‚¹æ•°æ€»å’Œ: " + doubleContainer.sum());
        System.out.println("æœ€å¤§å€¼: " + doubleContainer.max());
        
        // ç¼–è¯‘é”™è¯¯ï¼šStringä¸æ˜¯Numberçš„å­ç±»
        // NumericContainer<String> stringContainer = new NumericContainer<>(5);
    }
}
```

### 5. å¤šè¾¹ç•Œç±»å‹å‚æ•°

```
// ç±»å‹å‚æ•°å¿…é¡»åŒæ—¶å®ç°å¤šä¸ªæ¥å£
public class MultiBoundContainer<T extends Number & Comparable<T> & Serializable> {
    private T value;
    
    public MultiBoundContainer(T value) {
        this.value = value;
    }
    
    public boolean isGreaterThan(T other) {
        return value.compareTo(other) > 0;  // å¯ä»¥è°ƒç”¨Comparableçš„æ–¹æ³•
    }
    
    public void serialize() {
        // å¯ä»¥åºåˆ—åŒ–ï¼Œå› ä¸ºTå®ç°äº†Serializable
    }
}

// æ³¨æ„ï¼šç±»å¿…é¡»åœ¨å‰é¢ï¼Œæ¥å£åœ¨åé¢
// æ­£ç¡®ï¼š<T extends Number & Comparable<T> & Serializable>
// é”™è¯¯ï¼š<T extends Comparable<T> & Number & Serializable>
```

---

## ğŸ”§ æ–¹æ³•æ³›å‹

### 1. åŸºæœ¬è¯­æ³•

```
// æ™®é€šç±»ä¸­çš„æ³›å‹æ–¹æ³•
public class GenericMethods {
    
    // æ³›å‹æ–¹æ³•ï¼šåœ¨è¿”å›ç±»å‹å‰å£°æ˜ç±»å‹å‚æ•°<T>
    public static <T> void printArray(T[] array) {
        for (T element : array) {
            System.out.print(element + " ");
        }
        System.out.println();
    }
    
    // æ³›å‹æ–¹æ³•å¯ä»¥æœ‰è¿”å›ç±»å‹
    public static <T> T getFirstElement(T[] array) {
        if (array == null || array.length == 0) {
            return null;
        }
        return array[0];
    }
    
    // å¤šä¸ªç±»å‹å‚æ•°çš„æ³›å‹æ–¹æ³•
    public static <K, V> Map<K, V> createMap(K key, V value) {
        Map<K, V> map = new HashMap<>();
        map.put(key, value);
        return map;
    }
    
    // æœ‰ç•Œç±»å‹å‚æ•°çš„æ³›å‹æ–¹æ³•
    public static <T extends Comparable<T>> T max(T a, T b, T c) {
        T max = a;
        if (b.compareTo(max) > 0) {
            max = b;
        }
        if (c.compareTo(max) > 0) {
            max = c;
        }
        return max;
    }
}
```

### 2. æ³›å‹ç±»ä¸­çš„æ³›å‹æ–¹æ³•

```
public class GenericClassWithMethods<T> {
    private T data;
    
    public GenericClassWithMethods(T data) {
        this.data = data;
    }
    
    public T getData() {
        return data;
    }
    
    // è¿™ä¸æ˜¯æ³›å‹æ–¹æ³•ï¼è¿™åªæ˜¯ä½¿ç”¨äº†ç±»çš„ç±»å‹å‚æ•°
    public void setData(T data) {
        this.data = data;
    }
    
    // è¿™æ‰æ˜¯æ³›å‹æ–¹æ³•ï¼šæœ‰è‡ªå·±çš„ç±»å‹å‚æ•°E
    public <E> void processArray(E[] array) {
        for (E element : array) {
            System.out.println(element);
        }
    }
    
    // æ³›å‹æ–¹æ³•å¯ä»¥ä½¿ç”¨ä¸åŒçš„ç±»å‹å‚æ•°
    public <U> void printBoth(U other) {
        System.out.println("ç±»ç±»å‹å‚æ•°: " + data);
        System.out.println("æ–¹æ³•ç±»å‹å‚æ•°: " + other);
    }
    
    // æ³›å‹é™æ€æ–¹æ³•ï¼ˆä¸èƒ½ä½¿ç”¨ç±»çš„ç±»å‹å‚æ•°ï¼‰
    public static <S> S firstElement(S[] array) {
        if (array == null || array.length == 0) {
            return null;
        }
        return array[0];
    }
}
```

### 3. å®Œæ•´ç¤ºä¾‹

```
import java.util.*;

public class GenericMethodDemo {
    
    // 1. åŸºæœ¬æ³›å‹æ–¹æ³•ç¤ºä¾‹
    public static <T> void swap(T[] array, int i, int j) {
        if (i < 0 || i >= array.length || j < 0 || j >= array.length) {
            throw new IndexOutOfBoundsException("ç´¢å¼•è¶Šç•Œ");
        }
        T temp = array[i];
        array[i] = array[j];
        array[j] = temp;
    }
    
    // 2. æŸ¥æ‰¾æ•°ç»„ä¸­çš„æœ€å¤§å€¼
    public static <T extends Comparable<T>> T findMax(T[] array) {
        if (array == null || array.length == 0) {
            return null;
        }
        
        T max = array[0];
        for (int i = 1; i < array.length; i++) {
            if (array[i].compareTo(max) > 0) {
                max = array[i];
            }
        }
        return max;
    }
    
    // 3. æ•°ç»„è½¬æ¢ä¸ºåˆ—è¡¨
    public static <T> List<T> arrayToList(T[] array) {
        List<T> list = new ArrayList<>();
        Collections.addAll(list, array);
        return list;
    }
    
    // 4. åˆå¹¶ä¸¤ä¸ªæ•°ç»„
    public static <T> T[] mergeArrays(T[] first, T[] second) {
        @SuppressWarnings("unchecked")
        T[] result = (T[]) new Object[first.length + second.length];
        System.arraycopy(first, 0, result, 0, first.length);
        System.arraycopy(second, 0, result, first.length, second.length);
        return result;
    }
    
    // 5. ç»Ÿè®¡å…ƒç´ å‡ºç°æ¬¡æ•°
    public static <T> Map<T, Integer> countOccurrences(T[] array) {
        Map<T, Integer> counts = new HashMap<>();
        for (T element : array) {
            counts.put(element, counts.getOrDefault(element, 0) + 1);
        }
        return counts;
    }
    
    // 6. é€šé…ç¬¦æ–¹æ³•
    public static void printList(List<?> list) {
        for (Object element : list) {
            System.out.print(element + " ");
        }
        System.out.println();
    }
    
    // 7. ä¸Šç•Œé€šé…ç¬¦
    public static double sumOfNumbers(List<? extends Number> numbers) {
        double sum = 0.0;
        for (Number num : numbers) {
            sum += num.doubleValue();
        }
        return sum;
    }
    
    // 8. ä¸‹ç•Œé€šé…ç¬¦
    public static void addIntegers(List<? super Integer> list) {
        for (int i = 1; i <= 5; i++) {
            list.add(i);
        }
    }
    
    public static void main(String[] args) {
        // æµ‹è¯•swapæ–¹æ³•
        Integer[] intArray = {1, 2, 3, 4, 5};
        System.out.println("äº¤æ¢å‰: " + Arrays.toString(intArray));
        swap(intArray, 0, 4);
        System.out.println("äº¤æ¢å: " + Arrays.toString(intArray));
        
        // æµ‹è¯•findMaxæ–¹æ³•
        String[] strArray = {"apple", "banana", "cherry", "date"};
        String maxString = findMax(strArray);
        System.out.println("æœ€å¤§å­—ç¬¦ä¸²: " + maxString);
        
        Double[] doubleArray = {3.14, 2.718, 1.618, 0.577};
        Double maxDouble = findMax(doubleArray);
        System.out.println("æœ€å¤§æ•°å­—: " + maxDouble);
        
        // æµ‹è¯•arrayToListæ–¹æ³•
        List<String> stringList = arrayToList(strArray);
        System.out.println("å­—ç¬¦ä¸²åˆ—è¡¨: " + stringList);
        
        // æµ‹è¯•countOccurrencesæ–¹æ³•
        String[] words = {"a", "b", "a", "c", "b", "a"};
        Map<String, Integer> wordCounts = countOccurrences(words);
        System.out.println("å•è¯ç»Ÿè®¡: " + wordCounts);
        
        // æµ‹è¯•é€šé…ç¬¦æ–¹æ³•
        printList(stringList);
        
        // æµ‹è¯•ä¸Šç•Œé€šé…ç¬¦
        List<Integer> integers = Arrays.asList(1, 2, 3, 4, 5);
        List<Double> doubles = Arrays.asList(1.1, 2.2, 3.3);
        System.out.println("æ•´æ•°å’Œ: " + sumOfNumbers(integers));
        System.out.println("æµ®ç‚¹æ•°å’Œ: " + sumOfNumbers(doubles));
        
        // æµ‹è¯•ä¸‹ç•Œé€šé…ç¬¦
        List<Number> numberList = new ArrayList<>();
        addIntegers(numberList);
        System.out.println("æ·»åŠ æ•´æ•°å: " + numberList);
        
        List<Object> objectList = new ArrayList<>();
        addIntegers(objectList);
        System.out.println("æ·»åŠ åˆ°Objectåˆ—è¡¨: " + objectList);
    }
}
```

### 4. æ³›å‹æ–¹æ³•ä¸ç±»å‹æ¨æ–­

```
public class TypeInferenceDemo {
    
    // æ³›å‹æ–¹æ³•
    public static <T> T identity(T input) {
        return input;
    }
    
    // å¤æ‚æ³›å‹æ–¹æ³•
    public static <T> List<T> filter(List<T> list, Predicate<T> predicate) {
        List<T> result = new ArrayList<>();
        for (T element : list) {
            if (predicate.test(element)) {
                result.add(element);
            }
        }
        return result;
    }
    
    // å‡½æ•°å¼æ¥å£
    interface Predicate<T> {
        boolean test(T t);
    }
    
    public static void main(String[] args) {
        // ç±»å‹æ¨æ–­ï¼šç¼–è¯‘å™¨è‡ªåŠ¨æ¨æ–­ç±»å‹
        String str = identity("Hello");  // æ¨æ–­Tä¸ºString
        Integer num = identity(100);     // æ¨æ–­Tä¸ºInteger
        
        // æ˜¾å¼æŒ‡å®šç±»å‹
        String explicit = TypeInferenceDemo.<String>identity("World");
        
        // è¿‡æ»¤ç¤ºä¾‹
        List<Integer> numbers = Arrays.asList(1, 2, 3, 4, 5, 6, 7, 8, 9, 10);
        List<Integer> evenNumbers = filter(numbers, n -> n % 2 == 0);
        System.out.println("å¶æ•°: " + evenNumbers);
        
        List<String> strings = Arrays.asList("Java", "Python", "C++", "JavaScript", "Go");
        List<String> longStrings = filter(strings, s -> s.length() > 4);
        System.out.println("é•¿å­—ç¬¦ä¸²: " + longStrings);
    }
}
```

---

## ğŸ”Œ æ¥å£æ³›å‹

### 1. åŸºæœ¬è¯­æ³•

```
// å®šä¹‰æ³›å‹æ¥å£
public interface InterfaceName<T> {
    void process(T item);
    T getResult();
}
```

### 2. å®Œæ•´ç¤ºä¾‹

```
// æ³›å‹æ¥å£ï¼šä»“åº“æ¥å£
public interface Repository<T, ID> {
    void save(T entity);
    T findById(ID id);
    void update(T entity);
    void delete(ID id);
    List<T> findAll();
}

// æ³›å‹æ¥å£ï¼šæ¯”è¾ƒå™¨æ¥å£
public interface Comparator<T> {
    int compare(T o1, T o2);
    boolean equals(Object obj);
}

// æ³›å‹æ¥å£ï¼šç”Ÿæˆå™¨æ¥å£
public interface Generator<T> {
    T next();
}
```

### 3. æ¥å£å®ç°æ–¹å¼

```
// æ–¹å¼1ï¼šå®ç°å…·ä½“ç±»å‹
public class StringRepository implements Repository<String, Long> {
    private Map<Long, String> storage = new HashMap<>();
    private long currentId = 1;
    
    @Override
    public void save(String entity) {
        storage.put(currentId++, entity);
    }
    
    @Override
    public String findById(Long id) {
        return storage.get(id);
    }
    
    @Override
    public void update(String entity) {
        // ç®€åŒ–å®ç°ï¼šéœ€è¦çŸ¥é“id
    }
    
    @Override
    public void delete(Long id) {
        storage.remove(id);
    }
    
    @Override
    public List<String> findAll() {
        return new ArrayList<>(storage.values());
    }
}

// æ–¹å¼2ï¼šå®ç°æ³›å‹æ¥å£
public class GenericRepository<T, ID> implements Repository<T, ID> {
    private Map<ID, T> storage = new HashMap<>();
    
    @Override
    public void save(T entity) {
        // éœ€è¦å¤„ç†IDç”Ÿæˆ
    }
    
    @Override
    public T findById(ID id) {
        return storage.get(id);
    }
    
    @Override
    public void update(T entity) {
        // éœ€è¦çŸ¥é“ID
    }
    
    @Override
    public void delete(ID id) {
        storage.remove(id);
    }
    
    @Override
    public List<T> findAll() {
        return new ArrayList<>(storage.values());
    }
}

// æ–¹å¼3ï¼šå®ç°æœ‰ç•Œæ³›å‹æ¥å£
public class NumberGenerator implements Generator<Number> {
    private int count = 0;
    
    @Override
    public Number next() {
        return count++;
    }
}
```

### 4. å¤æ‚ç¤ºä¾‹

```
// 1. æ³›å‹æ¥å£ï¼šå¯åºåˆ—åŒ–å®¹å™¨
public interface SerializableContainer<T extends Serializable> {
    void add(T item);
    T get(int index);
    int size();
    void serialize(String filename) throws IOException;
    void deserialize(String filename) throws IOException, ClassNotFoundException;
}

// 2. æ³›å‹æ¥å£ï¼šç¼“å­˜æ¥å£
public interface Cache<K, V> {
    void put(K key, V value);
    V get(K key);
    void remove(K key);
    void clear();
    int size();
    boolean containsKey(K key);
    Set<K> keySet();
}

// 3. å®ç°ç¼“å­˜æ¥å£
public class LRUCache<K, V> implements Cache<K, V> {
    private final int capacity;
    private final LinkedHashMap<K, V> map;
    
    public LRUCache(int capacity) {
        this.capacity = capacity;
        this.map = new LinkedHashMap<K, V>(capacity, 0.75f, true) {
            @Override
            protected boolean removeEldestEntry(Map.Entry<K, V> eldest) {
                return size() > capacity;
            }
        };
    }
    
    @Override
    public void put(K key, V value) {
        map.put(key, value);
    }
    
    @Override
    public V get(K key) {
        return map.get(key);
    }
    
    @Override
    public void remove(K key) {
        map.remove(key);
    }
    
    @Override
    public void clear() {
        map.clear();
    }
    
    @Override
    public int size() {
        return map.size();
    }
    
    @Override
    public boolean containsKey(K key) {
        return map.containsKey(key);
    }
    
    @Override
    public Set<K> keySet() {
        return map.keySet();
    }
}

// 4. æ³›å‹æ¥å£ï¼šæ•°æ®è®¿é—®å¯¹è±¡
public interface DAO<T, ID> {
    ID create(T entity);
    T read(ID id);
    void update(T entity);
    void delete(ID id);
    List<T> list();
    List<T> find(Criteria criteria);
    
    // åµŒå¥—æ³›å‹æ¥å£
    interface Criteria {
        boolean test(Object entity);
    }
}
```

### 5. æ¥å£ç»§æ‰¿ç¤ºä¾‹

```
// åŸºæ¥å£
public interface BaseRepository<T> {
    void save(T entity);
    T findById(Long id);
}

// æ‰©å±•æ¥å£
public interface ExtendedRepository<T> extends BaseRepository<T> {
    List<T> findAll();
    List<T> findByCondition(String condition);
    long count();
}

// å¸¦æœ‰é™åˆ¶çš„æ¥å£ç»§æ‰¿
public interface NumericRepository<T extends Number> extends BaseRepository<T> {
    T sum();
    T average();
    T max();
    T min();
}

// å¤šé‡ç±»å‹å‚æ•°çš„æ¥å£ç»§æ‰¿
public interface KeyValueRepository<K, V> extends BaseRepository<Map.Entry<K, V>> {
    V getByKey(K key);
    void put(K key, V value);
    void removeByKey(K key);
    Set<K> keySet();
    Collection<V> values();
}
```

---

## ğŸ”„ æ³›å‹é€šé…ç¬¦

### 1. é€šé…ç¬¦ç±»å‹

```
// 1. æ— ç•Œé€šé…ç¬¦: ?
public void processList(List<?> list) {
    for (Object obj : list) {
        System.out.println(obj);
    }
    // ä¸èƒ½æ·»åŠ å…ƒç´ ï¼ˆé™¤äº†nullï¼‰
    // list.add("test");  // ç¼–è¯‘é”™è¯¯
}

// 2. ä¸Šç•Œé€šé…ç¬¦: ? extends T
public double sumList(List<? extends Number> numbers) {
    double sum = 0.0;
    for (Number num : numbers) {
        sum += num.doubleValue();
    }
    return sum;
}

// 3. ä¸‹ç•Œé€šé…ç¬¦: ? super T
public void addNumbers(List<? super Integer> list) {
    for (int i = 1; i <= 10; i++) {
        list.add(i);  // å¯ä»¥æ·»åŠ IntegeråŠå…¶å­ç±»
    }
}
```

### 2. PECS åŸåˆ™

```
// Producer Extends, Consumer Super
public class PECSDemo {
    
    // Producer: ä»é›†åˆè¯»å–æ•°æ®ï¼ˆä½¿ç”¨extendsï¼‰
    public static double sum(Collection<? extends Number> numbers) {
        double total = 0.0;
        for (Number num : numbers) {
            total += num.doubleValue();
        }
        return total;
    }
    
    // Consumer: å‘é›†åˆæ·»åŠ æ•°æ®ï¼ˆä½¿ç”¨superï¼‰
    public static void addIntegers(List<? super Integer> list) {
        for (int i = 0; i < 10; i++) {
            list.add(i);
        }
    }
    
    // åŒæ—¶ä½œä¸ºç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…
    public static <T> void copy(List<? super T> dest, List<? extends T> src) {
        for (T element : src) {
            dest.add(element);
        }
    }
    
    public static void main(String[] args) {
        // Producerç¤ºä¾‹
        List<Integer> integers = Arrays.asList(1, 2, 3, 4, 5);
        System.out.println("æ•´æ•°å’Œ: " + sum(integers));
        
        List<Double> doubles = Arrays.asList(1.1, 2.2, 3.3);
        System.out.println("æµ®ç‚¹æ•°å’Œ: " + sum(doubles));
        
        // Consumerç¤ºä¾‹
        List<Number> numbers = new ArrayList<>();
        addIntegers(numbers);
        System.out.println("æ·»åŠ åçš„åˆ—è¡¨: " + numbers);
        
        // å¤åˆ¶ç¤ºä¾‹
        List<Integer> source = Arrays.asList(1, 2, 3, 4, 5);
        List<Number> destination = new ArrayList<>();
        copy(destination, source);
        System.out.println("å¤åˆ¶ç»“æœ: " + destination);
    }
}
```

---

## âš¡ ç±»å‹æ“¦é™¤ä¸æ¡¥æ¥æ–¹æ³•

### 1. ç±»å‹æ“¦é™¤ç¤ºä¾‹

```
// ç¼–è¯‘å‰
public class ErasureDemo<T> {
    private T value;
    
    public void setValue(T value) {
        this.value = value;
    }
    
    public T getValue() {
        return value;
    }
}

// ç¼–è¯‘åï¼ˆç±»å‹æ“¦é™¤ï¼‰
public class ErasureDemo {
    private Object value;  // Tè¢«æ“¦é™¤ä¸ºObject
    
    public void setValue(Object value) {
        this.value = value;
    }
    
    public Object getValue() {
        return value;
    }
}
```

### 2. æ¡¥æ¥æ–¹æ³•

```
// çˆ¶ç±»
class Parent<T> {
    public void set(T value) {
        System.out.println("Parent.set");
    }
}

// å­ç±»
class Child extends Parent<String> {
    // ç¼–è¯‘å™¨ä¼šç”Ÿæˆæ¡¥æ¥æ–¹æ³•
    @Override
    public void set(String value) {
        System.out.println("Child.set: " + value);
    }
    
    // ç¼–è¯‘å™¨ç”Ÿæˆçš„æ¡¥æ¥æ–¹æ³•
    // public void set(Object value) {
    //     set((String) value);  // ç±»å‹è½¬æ¢
    // }
}
```

---

## ğŸ¯ å®é™…åº”ç”¨ç¤ºä¾‹

### ç¤ºä¾‹1ï¼šæ³›å‹DAOå®ç°

```
// æ³›å‹DAOæ¥å£
public interface GenericDAO<T, ID> {
    ID create(T entity);
    T read(ID id);
    void update(T entity);
    void delete(ID id);
    List<T> findAll();
    List<T> findByCriteria(Criteria<T> criteria);
    
    interface Criteria<T> {
        boolean test(T entity);
    }
}

// æ³›å‹DAOå®ç°
public abstract class AbstractDAO<T, ID> implements GenericDAO<T, ID> {
    private final Class<T> entityClass;
    private final Map<ID, T> storage = new HashMap<>();
    
    protected AbstractDAO(Class<T> entityClass) {
        this.entityClass = entityClass;
    }
    
    @Override
    public ID create(T entity) {
        ID id = generateId();
        storage.put(id, entity);
        return id;
    }
    
    @Override
    public T read(ID id) {
        return storage.get(id);
    }
    
    @Override
    public void update(T entity) {
        // éœ€è¦çŸ¥é“ID
    }
    
    @Override
    public void delete(ID id) {
        storage.remove(id);
    }
    
    @Override
    public List<T> findAll() {
        return new ArrayList<>(storage.values());
    }
    
    @Override
    public List<T> findByCriteria(Criteria<T> criteria) {
        List<T> result = new ArrayList<>();
        for (T entity : storage.values()) {
            if (criteria.test(entity)) {
                result.add(entity);
            }
        }
        return result;
    }
    
    protected abstract ID generateId();
}

// å…·ä½“DAOå®ç°
public class UserDAO extends AbstractDAO<User, Long> {
    private long currentId = 1;
    
    public UserDAO() {
        super(User.class);
    }
    
    @Override
    protected Long generateId() {
        return currentId++;
    }
    
    // ç‰¹å®šäºUserçš„æ–¹æ³•
    public List<User> findByName(String name) {
        return findByCriteria(user -> name.equals(user.getName()));
    }
}

// å®ä½“ç±»
class User {
    private String name;
    private int age;
    
    // æ„é€ æ–¹æ³•ã€getterã€setter
}
```

### ç¤ºä¾‹2ï¼šæ³›å‹æ„å»ºå™¨æ¨¡å¼

```
// æ³›å‹æ„å»ºå™¨
public class GenericBuilder<T> {
    private final Supplier<T> instantiator;
    private List<Consumer<T>> modifiers = new ArrayList<>();
    
    public GenericBuilder(Supplier<T> instantiator) {
        this.instantiator = instantiator;
    }
    
    public static <T> GenericBuilder<T> of(Supplier<T> instantiator) {
        return new GenericBuilder<>(instantiator);
    }
    
    public <U> GenericBuilder<T> with(BiConsumer<T, U> consumer, U value) {
        Consumer<T> c = instance -> consumer.accept(instance, value);
        modifiers.add(c);
        return this;
    }
    
    public T build() {
        T value = instantiator.get();
        modifiers.forEach(modifier -> modifier.accept(value));
        modifiers.clear();
        return value;
    }
}

// ä½¿ç”¨ç¤ºä¾‹
class Person {
    private String name;
    private int age;
    private String address;
    
    // æ„é€ æ–¹æ³•ã€getterã€setter
    
    public static void main(String[] args) {
        Person person = GenericBuilder.of(Person::new)
                .with(Person::setName, "å¼ ä¸‰")
                .with(Person::setAge, 25)
                .with(Person::setAddress, "åŒ—äº¬")
                .build();
    }
}
```

---

## ğŸ’¡ æœ€ä½³å®è·µ

### 1. å‘½åçº¦å®š

```
// å¸¸ç”¨ç±»å‹å‚æ•°å
E - Element (é›†åˆä¸­çš„å…ƒç´ )
K - Key (é”®)
V - Value (å€¼)
N - Number (æ•°å­—)
T - Type (ç±»å‹)
S, U, V - ç¬¬2ã€3ã€4ä¸ªç±»å‹å‚æ•°
```

### 2. ä½¿ç”¨å»ºè®®

```
// 1. ä¼˜å…ˆä½¿ç”¨æ³›å‹æ–¹æ³•è€Œä¸æ˜¯é€šé…ç¬¦
public static <T> void copy(List<T> dest, List<? extends T> src) {
    // æ›´å¥½çš„ç±»å‹å®‰å…¨
}

// 2. é¿å…åŸå§‹ç±»å‹
// ä¸è¦ä½¿ç”¨
List list = new ArrayList();  // åŸå§‹ç±»å‹
// åº”è¯¥ä½¿ç”¨
List<String> list = new ArrayList<>();

// 3. æ³¨æ„æ•°ç»„ä¸æ³›å‹çš„å…¼å®¹æ€§
// ä¸è¦åˆ›å»ºæ³›å‹æ•°ç»„
// T[] array = new T[10];  // é”™è¯¯
// åº”è¯¥ä½¿ç”¨åˆ—è¡¨
List<T> list = new ArrayList<>();

// 4. ä½¿ç”¨@SuppressWarningsæ³¨è§£
@SuppressWarnings("unchecked")
public T[] toArray(T[] a) {
    // çŸ¥é“è‡ªå·±åœ¨åšä»€ä¹ˆ
}
```

---

## ğŸ“Š æ€»ç»“

### ç±»æ³›å‹

- åœ¨ç±»å®šä¹‰æ—¶å£°æ˜ç±»å‹å‚æ•°
    
- ç”¨äºåˆ›å»ºå¯é‡ç”¨çš„é€šç”¨ç±»
    
- å¯ä»¥åœ¨å­—æ®µã€æ–¹æ³•ã€æ„é€ æ–¹æ³•ä¸­ä½¿ç”¨
    
- æ”¯æŒæœ‰ç•Œç±»å‹å‚æ•°
    

### æ–¹æ³•æ³›å‹

- åœ¨æ–¹æ³•è¿”å›ç±»å‹å‰å£°æ˜ç±»å‹å‚æ•°
    
- å¯ä»¥ç‹¬ç«‹äºç±»çš„ç±»å‹å‚æ•°
    
- æ”¯æŒç±»å‹æ¨æ–­
    
- å¸¸ç”¨äºå·¥å…·ç±»å’Œé™æ€æ–¹æ³•
    

### æ¥å£æ³›å‹

- åœ¨æ¥å£å®šä¹‰æ—¶å£°æ˜ç±»å‹å‚æ•°
    
- å®ç°æ—¶å¯ä»¥æŒ‡å®šå…·ä½“ç±»å‹
    
- æ”¯æŒæ¥å£ç»§æ‰¿å’Œæ‰©å±•
    
- å¸¸ç”¨äºå®šä¹‰é€šç”¨å¥‘çº¦
    

### æ ¸å¿ƒè¦ç‚¹

1. **ç±»å‹å®‰å…¨**ï¼šç¼–è¯‘æ—¶æ£€æŸ¥ï¼Œå‡å°‘è¿è¡Œæ—¶é”™è¯¯
    
2. **ä»£ç å¤ç”¨**ï¼šä¸€å¥—ä»£ç å¤„ç†å¤šç§ç±»å‹
    
3. **æ¶ˆé™¤å¼ºåˆ¶è½¬æ¢**ï¼šä»£ç æ›´ç®€æ´
    
4. **é€šé…ç¬¦çµæ´»æ€§**ï¼š`? extends`å’Œ `? super`æä¾›çµæ´»æ€§
    
5. **ç±»å‹æ“¦é™¤**ï¼šJavaæ³›å‹çš„å®ç°æœºåˆ¶
    

ç†è§£å¹¶ç†Ÿç»ƒä½¿ç”¨æ³›å‹æ˜¯æˆä¸ºé«˜çº§Javaå¼€å‘è€…çš„é‡è¦æ ‡å¿—ã€‚å®ƒä¸ä»…èƒ½æé«˜ä»£ç çš„è´¨é‡å’Œå¯ç»´æŠ¤æ€§ï¼Œè¿˜èƒ½ä½¿ä½ çš„ä»£ç æ›´åŠ çµæ´»å’Œå¼ºå¤§ã€‚