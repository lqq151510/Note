在Java中，解压缩流是用于处理压缩文件（如ZIP格式）的重要工具，它们能帮助我们读取压缩包中的内容。下面这个表格能帮你快速了解其核心类和用途。

|类名|核心作用|所属包|
|---|---|---|
|**`ZipInputStream`**​|**解压缩流**：从压缩包（如ZIP文件）中读取数据，并将其解压还原。|`java.util.zip`|
|**`ZipOutputStream`**​|**压缩流**：将数据压缩后写入到压缩包中。|`java.util.zip`|
|**`ZipEntry`**​|代表压缩包中的一个**文件或目录**，是操作的基本单元。|`java.util.zip`|

### 🔌 核心机制：ZipEntry

理解 `ZipEntry`是掌握解压缩流的关键。**一个压缩包（.zip文件）可以包含多个文件和文件夹，其中的每一个项目（一个文件或一个空文件夹）在Java中都被抽象为一个 `ZipEntry`对象**。解压缩的过程，就是遍历压缩包中的每一个 `ZipEntry`，然后将其数据读取出来，并按照原有的目录结构拷贝到本地。

### 🛠️ 如何使用解压缩流

解压缩一个ZIP文件的标准步骤如下，关键在于循环处理每个 `ZipEntry`。

**基本步骤**：

1. **创建流对象**：用 `FileInputStream`包裹压缩包文件，再将其传递给 `ZipInputStream`。
    
2. **遍历ZipEntry**：循环调用 `zipIn.getNextEntry()`，直到返回 `null`，表示所有条目已处理完毕。
    
3. **处理条目**：
    
    - **如果是目录**：根据 `ZipEntry`的名称在目标位置创建相应的文件夹。
        
    - **如果是文件**：读取该 `ZipEntry`的数据，并在目标位置创建文件并将数据写入。
        
    
4. **关闭当前条目**：处理完一个 `ZipEntry`后，调用 `zipIn.closeEntry()`。
    
5. **关闭流**：最终关闭 `ZipInputStream`。
    

下面是解压一个ZIP文件到指定目录的示例代码：

```
import java.io.*;
import java.util.zip.*;

public class UnzipExample {
    public static void main(String[] args) {
        File zipFile = new File("archive.zip"); // 源压缩包
        File destDir = new File("/path/to/destination"); // 解压目标目录

        try (ZipInputStream zipIn = new ZipInputStream(new FileInputStream(zipFile))) {
            destDir.mkdirs(); // 确保目标目录存在
            byte[] buffer = new byte[4096]; // 读写缓冲区
            ZipEntry entry;

            // 循环获取压缩包中的每一个文件/目录（ZipEntry）
            while ((entry = zipIn.getNextEntry()) != null) {
                File entryFile = new File(destDir, entry.getName());

                if (entry.isDirectory()) {
                    // 如果是目录，则创建目录
                    entryFile.mkdirs();
                } else {
                    // 如果是文件，则创建文件并写入数据
                    try (FileOutputStream fos = new FileOutputStream(entryFile)) {
                        int len;
                        while ((len = zipIn.read(buffer)) > 0) {
                            fos.write(buffer, 0, len);
                        }
                    }
                }
                zipIn.closeEntry(); // 关闭当前Entry，准备处理下一个
            }
            System.out.println("解压完成！");
        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}
```

### ⚠️ 关键要点

- **异常处理**：IO操作可能会抛出 `IOException`，务必使用 `try-catch`块进行妥善处理，或在方法签名上声明抛出。
    
- **资源管理**：使用 **try-with-resources**​ 语句（如上例）是管理流资源的最佳实践，它能确保流被正确关闭，避免资源泄漏。
    
- **目录结构**：解压时，`ZipEntry`的 `getName()`方法返回的是压缩包内的完整路径（如 `"docs/readme.txt"`）。在构建目标文件路径（`new File(destDir, entry.getName())`）时，会自动创建相应的子目录，从而**保持原始的目录层级结构**。
    
- **安全性**：在实际应用中，应对 `entry.getName()`进行安全检查，防止路径穿越攻击（例如，恶意构造包含 `../`的条目名，从而将文件解压到预期目录之外）。
    

### 💡 扩展与工具库

除了手动使用 `java.util.zip`包，一些优秀的第三方库如 **Apache Commons Compress**​ 提供了对更多压缩格式（如 .tar.gz, .7z）的支持和更简洁的API。对于简单的解压任务，也可以考虑使用Java 7引入的 **NIO.2**​ 文件系统提供者，它可以用类似操作普通目录的方式来访问ZIP文件。

希望这份梳理能帮助你清晰地掌握Java中的解压缩流。如果想了解压缩流（`ZipOutputStream`）的具体用法，或者有特定的应用场景，我们可以继续探讨。